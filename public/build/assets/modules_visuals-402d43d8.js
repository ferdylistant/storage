async function t(t,e){const n=document.getElementById("visuals");if(!n)return;const r=function(t,e){return debounce(()=>{"function"==typeof t&&t(),"function"==typeof e&&e()},150)}(t,e);try{const t=await fetch("/tab/visuals",{headers:{"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error("Failed to load visuals");const e=((await t.json()).items??[]).filter(t=>t&&t.src&&t.srct).map(t=>({src:t.src,srct:/Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent)?t.srct:t.src,tags:t.tags??""}));if(n.innerHTML='\n            <h2 style="font-family: Nickson, \'sans-serif\';">Visuals</h2>\n            <p class="text-center text-md-start mb-3">Click on an image to view it in a gallery.</p>\n            <div id="nanogalleryVisual"></div>\n        ',0===e.length)return void(document.getElementById("nanogalleryVisual").innerHTML='\n    <div class="text-center py-5 px-3 glass-timeline">\n        <div class="mb-3">\n            <svg xmlns="http://www.w3.org/2000/svg" width="72" height="72" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">\n                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>\n                <path d="M3 17l5-5 4 4 5-6 4 7"/>\n            </svg>\n        </div>\n        <h3 style="font-family: Nickson, \'sans-serif\'; letter-spacing: 0.3rem;">Coming Soon\n                                    </h3>\n                                    <p class="text-white text-center text-md-start mb-0">Posters, artwork, and trippy visuals are being\n                                        crafted.</p>\n    </div>\n');await async function(t){if(document.querySelector(`link[href*="${t.split("/").pop()}"]`))return;const e=document.createElement("link");e.rel="stylesheet",e.href=t,document.head.appendChild(e)}("https://cdn.jsdelivr.net/npm/nanogallery2/dist/css/nanogallery2.min.css"),await a("https://code.jquery.com/jquery-3.7.1.min.js","jQuery"),await a("https://cdn.jsdelivr.net/npm/nanogallery2/dist/jquery.nanogallery2.min.js","jQuery.fn.nanogallery2"),jQuery("#nanogalleryVisual").nanogallery2({items:e,galleryMosaic:[{w:2,h:2,c:1,r:1},{w:1,h:1,c:3,r:1},{w:1,h:1,c:3,r:2},{w:1,h:2,c:4,r:1},{w:2,h:1,c:5,r:1},{w:2,h:2,c:5,r:2},{w:1,h:1,c:4,r:3},{w:2,h:1,c:2,r:3},{w:1,h:2,c:1,r:3},{w:1,h:1,c:2,r:4},{w:2,h:1,c:3,r:4},{w:1,h:1,c:5,r:4},{w:1,h:1,c:6,r:4}],galleryMosaicXS:[{w:2,h:2,c:1,r:1},{w:1,h:1,c:3,r:1},{w:1,h:1,c:3,r:2},{w:1,h:2,c:1,r:3},{w:2,h:1,c:2,r:3},{w:1,h:1,c:2,r:4},{w:1,h:1,c:3,r:4}],galleryMosaicSM:[{w:2,h:2,c:1,r:1},{w:1,h:1,c:3,r:1},{w:1,h:1,c:3,r:2},{w:1,h:2,c:1,r:3},{w:2,h:1,c:2,r:3},{w:1,h:1,c:2,r:4},{w:1,h:1,c:3,r:4}],galleryMaxRows:2,gallerySorting:"random",thumbnailDisplayOrder:"random",galleryMaxItemsPerPage:20,galleryPaginationMode:"scroll",thumbnailHeight:"200",thumbnailWidth:"auto",thumbnailAlignment:"scaled",thumbnailGutterWidth:5,thumbnailGutterHeight:5,thumbnailBorderHorizontal:0,thumbnailBorderVertical:0,galleryDisplayMode:"fullContent",galleryDisplayTransitionDuration:800,thumbnailDisplayTransition:"imageSlideUp",thumbnailDisplayTransitionDuration:400,thumbnailDisplayInterval:20,touchAnimation:!0,touchAutoOpenDelay:500,thumbnailLabel:{display:!0,position:"onBottomOverImage",hideIcons:!0},viewerToolbar:{display:!1},viewerTools:{topLeft:"label",topRight:"shareButton, rotateLeft, rotateRight, fullscreenButton, closeButton"},locationHash:!1}),$("#nanogalleryVisual").on("galleryDisplayed.nanogallery2",function(){requestAnimationFrame(()=>setTimeout(r,80))})}catch(i){n.innerHTML='\n            <div class="alert alert-danger text-center mt-4">\n                Failed to load visuals. Please try again later.\n            </div>'}async function a(t,e){return new Promise((n,r)=>{if(e.split(".").reduce((t,e)=>t?t[e]:void 0,window))return n();const a=document.createElement("script");a.src=t,a.async=!0,a.onload=()=>{e.split(".").reduce((t,e)=>t?t[e]:void 0,window)?n():r(new Error(`Script loaded but ${e} not found`))},a.onerror=()=>r(new Error(`Failed to load script: ${t}`)),document.head.appendChild(a)})}}export{t as initVisuals};
