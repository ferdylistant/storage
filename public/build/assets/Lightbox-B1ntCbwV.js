import{r as e,n as t,j as i}from"./vendor-react-TIcaECwL.js";import{S as n}from"./scroll-area-DQiYg7e5.js";import{A as r,m as s}from"./vendor-motion-Ox8Ci54R.js";function a({open:a,items:x=[],index:p=0,onClose:v,onPrev:w,onNext:y,onSelectIndex:b}){const j=x?.[p],k=x?.length??0,[N,C]=e.useState(!1),[M,L]=e.useState(!0),[R,T]=e.useState(1),[E,_]=e.useState({x:0,y:0}),[P,W]=e.useState(!1),[D,S]=e.useState(!1),[$,z]=e.useState(!1),[B,A]=e.useState(0),F=e.useRef(null),I=e.useRef(0),Z=e.useRef(null),U=e.useRef(null),Y=e.useRef(null),O=p>0,q=p<k-1,G=(j?.type??"image").toLowerCase(),V="image"===G||"visual"===G||"photograph"===G,X="video"===G,H="youtube"===G,J="vimeo"===G,K=H||J,Q=()=>{L(!0),Z.current&&clearTimeout(Z.current)},ee=(e=1400)=>{Z.current&&clearTimeout(Z.current),Z.current=setTimeout(()=>L(!1),e)},te=()=>{T(1),_({x:0,y:0})},ie=()=>{V&&T(e=>Math.min(3.5,+(e+.25).toFixed(2)))},ne=()=>{V&&T(e=>{const t=Math.max(1,+(e-.25).toFixed(2));return 1===t&&_({x:0,y:0}),t})},re=e.useMemo(()=>D?{touchAction:"auto"}:V?{touchAction:R>1?"none":"pan-y"}:{touchAction:"auto"},[D,V,R]),se=e.useMemo(()=>D?{onTouchStart:void 0,onTouchMove:void 0,onTouchEnd:void 0}:{onTouchStart:e=>{if(Q(),ee(1400),V&&(1===e.touches.length&&(lastTouchRef.current={x:e.touches[0].clientX,y:e.touches[0].clientY}),2===e.touches.length)){const t=e.touches[0],i=e.touches[1];pinchRef.current={startDist:dist(t,i),startZoom:R}}},onTouchMove:e=>{if(V&&!(R<=1)){if(e.preventDefault(),1===e.touches.length&&lastTouchRef.current){const t=e.touches[0].clientX,i=e.touches[0].clientY,n=t-lastTouchRef.current.x,r=i-lastTouchRef.current.y;return lastTouchRef.current={x:t,y:i},void _(e=>le(e.x+n,e.y+r))}if(2===e.touches.length&&pinchRef.current){const t=e.touches[0],i=e.touches[1],n=dist(t,i)/pinchRef.current.startDist,r=pinchRef.current.startZoom*n,s=Math.max(1,Math.min(3.5,r));T(+s.toFixed(2)),s<=1.01&&_({x:0,y:0})}}},onTouchEnd:()=>{lastTouchRef.current=null,pinchRef.current=null,ee(1400)}},[D,V,R]);e.useEffect(()=>{if(!a)return;const e=document.documentElement,t=document.body,i=window.scrollY||window.pageYOffset,n=e.style.overflow,r=t.style.overflow,s=t.style.position,l=t.style.top,o=t.style.width,c=t.style.paddingRight,d=window.innerWidth-e.clientWidth;return d>0&&(t.style.paddingRight=`${d}px`),e.style.overflow="hidden",t.style.overflow="hidden",t.style.position="fixed",t.style.top=`-${i}px`,t.style.width="100%",()=>{e.style.overflow=n,t.style.overflow=r,t.style.position=s,t.style.top=l,t.style.width=o,t.style.paddingRight=c,window.scrollTo(0,i)}},[a]),e.useEffect(()=>(C(!0),()=>C(!1)),[]),e.useEffect(()=>{if(a){if(te(),Y.current)try{Y.current.pause(),Y.current.currentTime=0}catch{}V||z(!1)}},[p,a]),e.useEffect(()=>{if(!a)return;const e=e=>{if("Escape"!==e.key){if(!D)if("ArrowLeft"!==e.key)if("ArrowRight"!==e.key){if(V){if("+"===e.key||"="===e.key)return void ie();if("-"===e.key)return void ne();if("r"===e.key.toLowerCase())return void te()}"g"!==e.key.toLowerCase()||S(e=>!e)}else q&&y?.();else O&&w?.()}else v?.()};return window.addEventListener("keydown",e,{passive:!1}),()=>window.removeEventListener("keydown",e)},[a,D,O,q,w,y,v,V]),e.useEffect(()=>{if(a)return Q(),ee(1400),()=>{Z.current&&clearTimeout(Z.current)}},[a]),e.useEffect(()=>{if(!a)return;if(!$)return;if(D)return;if(!V)return;let e=!1,t=null;return(()=>{I.current=performance.now(),A(0);const i=t=>{if(e)return;const n=t-I.current,r=Math.min(1,n/2200);A(r),r<1&&(F.current=requestAnimationFrame(i))};F.current=requestAnimationFrame(i),t=setTimeout(()=>{if(!e)return p>=k-1?(z(!1),void A(0)):void y?.()},2200)})(),()=>{e=!0,t&&clearTimeout(t),F.current&&cancelAnimationFrame(F.current)}},[a,$,D,p,k,y,V]);const ae=()=>{W(!1),ee(1400)},le=(e,t)=>{const i=420*(R-1);return{x:Math.max(-i,Math.min(i,e)),y:Math.max(-i,Math.min(i,t))}},oe=e.useMemo(()=>x??[],[x]),ce=function(e){if(!e)return null;try{const t=new URL(e);return t.hostname.includes("youtu.be")?t.pathname.replace("/",""):t.hostname.includes("youtube.com")?t.searchParams.get("v"):null}catch{return null}}(j?.src),de=function(e){if(!e)return null;try{const t=new URL(e);if(!t.hostname.includes("vimeo.com"))return null;const i=t.pathname.split("/").filter(Boolean),n=i[i.length-1];return n?n.replace(/\D/g,""):null}catch{return null}}(j?.src),ue=e.useMemo(()=>H?ce?`https://www.youtube-nocookie.com/embed/${ce}?autoplay=0&mute=1&rel=0&modestbranding=1&playsinline=1`:null:J&&de?`https://player.vimeo.com/video/${de}?autoplay=1&muted=1&title=0&byline=0&portrait=0`:null,[H,J,ce,de]),he=`${G}-${p}-${ue??"no-src"}`;return N&&a&&j?t.createPortal(i.jsx(r,{children:i.jsxs(s.div,{ref:U,className:"\n                fixed inset-0 z-999999\n                overscroll-none\n                pt-[env(safe-area-inset-top)]\n                pb-[env(safe-area-inset-bottom)]\n                pl-[env(safe-area-inset-left)]\n                pr-[env(safe-area-inset-right)]",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.18},onMouseMove:()=>{Q(),ee(1400)},onClick:()=>{Q(),ee(1600)},children:[i.jsx("div",{className:"absolute inset-0 bg-black"}),i.jsx("div",{className:"absolute inset-0 opacity-[0.55] bg-[radial-gradient(circle_at_25%_20%,rgba(255,255,255,0.10),transparent_50%),radial-gradient(circle_at_75%_70%,rgba(140,190,255,0.10),transparent_55%),radial-gradient(circle_at_55%_40%,rgba(180,130,255,0.08),transparent_55%)]"}),i.jsx("div",{className:"absolute inset-0 opacity-[0.85] bg-[radial-gradient(ellipse_at_center,rgba(0,0,0,0.10)_0%,rgba(0,0,0,0.75)_55%,rgba(0,0,0,0.95)_100%)]"}),i.jsx("div",{className:"absolute inset-0 opacity-[0.10] mix-blend-overlay [background-image:url('data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22160%22 height=%22160%22%3E%3Cfilter id=%22n%22%3E%3CfeTurbulence type=%22fractalNoise%22 baseFrequency=%220.85%22 numOctaves=%222%22 stitchTiles=%22stitch%22/%3E%3C/filter%3E%3Crect width=%22160%22 height=%22160%22 filter=%22url(%23n)%22 opacity=%220.35%22/%3E%3C/svg%3E')"}),i.jsx(r,{children:M&&i.jsxs(s.div,{className:"\n                            absolute left-3 right-3 top-3 z-10\n                            flex flex-col md:flex-row\n                            md:items-center md:justify-between\n                            gap-2\n                            ",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.18},onClick:e=>e.stopPropagation(),children:[V&&i.jsxs("div",{className:"flex flex-wrap items-center justify-between md:justify-start gap-2 rounded-full bg-black/35 px-2 py-2 ring-1 ring-white/10 backdrop-blur-xl w-full md:w-auto",children:[i.jsx(l,{title:"Zoom In (+)",disabled:!V,onClick:()=>{Q(),ie()},icon:i.jsx(o,{})}),i.jsx(l,{title:"Zoom Out (-)",disabled:!V,onClick:()=>{Q(),ne()},icon:i.jsx(c,{})}),i.jsx(l,{title:"Reset (R)",disabled:!V,onClick:()=>{Q(),te()},icon:i.jsx(d,{})}),i.jsx("div",{className:"mx-1 h-5 w-px bg-white/10"}),i.jsx("div",{className:"px-2 text-[11px] tracking-[0.25em] text-white/55",children:V?`${Math.round(100*R)}%`:"MEDIA"})]}),i.jsx(r,{children:M&&!V&&i.jsx(s.div,{className:"hidden md:flex pointer-events-none flex-wrap items-center justify-between md:justify-start gap-2 rounded-full bg-black/35 px-2 py-2 ring-1 ring-white/10 backdrop-blur-xl w-full md:w-auto",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},children:i.jsxs("div",{className:"bg-black/35 px-4 py-2 text-[11px] tracking-[0.35em] text-white/65 backdrop-blur-xl",children:[p+1,"/",k]})})}),i.jsxs("div",{className:"hidden md:flex items-center gap-3 rounded-full bg-black/35 px-4 py-2 ring-1 ring-white/10 backdrop-blur-xl",children:[i.jsx("div",{className:"text-[11px] tracking-[0.35em] text-white/65 uppercase",children:j.title??"UNTITLED"}),i.jsx("div",{className:"h-4 w-px bg-white/10"}),i.jsx("div",{className:"text-[11px] tracking-[0.35em] text-white/35",children:j.year??"—"})]}),i.jsxs("div",{className:"order-first md:order-last flex flex-wrap items-center justify-between md:justify-start gap-2 rounded-full bg-black/35 px-2 py-2 ring-1 ring-white/10 backdrop-blur-xl w-full md:w-auto",children:[i.jsx(l,{title:"Grid (G)",active:D,onClick:()=>{Q(),S(e=>!e)},icon:i.jsx(u,{})}),V&&i.jsx(i.Fragment,{children:i.jsx(l,{title:$?"Pause":"Play",active:$,disabled:!V,onClick:()=>{Q(),z(e=>!e),A(0)},icon:i.jsx(h,{playing:$,progress:$?B:0})})}),i.jsx("div",{className:"mx-1 h-5 w-px bg-white/10"}),i.jsx(l,{title:"Close (Esc)",onClick:()=>v?.(),icon:i.jsx(m,{})})]})]})}),i.jsx(r,{children:M&&V&&i.jsx(s.div,{className:"hidden md:flex pointer-events-none absolute left-4 top-18 md:top-18.5 z-10",initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},transition:{duration:.18},children:i.jsxs("div",{className:"rounded-full bg-black/35 px-4 py-2 text-[11px] tracking-[0.35em] text-white/65 ring-1 ring-white/10 backdrop-blur-xl",children:[p+1,"/",k]})})}),i.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-2 sm:p-3 md:p-8",onWheel:!D&&V?e=>{if(!V)return;e.preventDefault(),Q(),ee(1400);Math.sign(e.deltaY)>0?ne():ie()}:void 0,style:re,...se,children:i.jsxs("div",{className:"relative h-full w-full max-w-350 md:px-0",children:[i.jsx("div",{className:"pointer-events-none absolute inset-0 rounded-xl md:rounded-2xl ring-1 ring-white/10 shadow-[0_40px_160px_rgba(0,0,0,0.75)]"}),i.jsxs(s.div,{className:"absolute inset-0 flex items-center justify-center rounded-xl md:rounded-2xl overflow-hidden bg-black/20",initial:{opacity:0,scale:.985},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.99},transition:{duration:.2},onClick:e=>e.stopPropagation(),children:[V&&i.jsx(s.img,{src:j.cover,alt:j.title??"image",draggable:!1,className:"max-h-full max-w-full select-none object-contain",style:{transform:`translate3d(${E.x}px, ${E.y}px, 0) scale(${R})`,cursor:R>1?P?"grabbing":"grab":"zoom-in"},onDoubleClick:e=>{e.stopPropagation(),Q(),1===R?T(2):te()},onMouseDown:e=>{R<=1||(e.preventDefault(),V&&(R<=1||(W(!0),Q())))},onMouseUp:()=>ae(),onMouseLeave:()=>ae(),onMouseMove:e=>{if(!P)return;e.preventDefault();const t=E.x+e.movementX,i=E.y+e.movementY;_(le(t,i))}}),X&&i.jsx("div",{className:"w-full h-full flex items-center justify-center p-3 md:p-6",children:i.jsx("div",{className:"w-full max-w-5xl overflow-hidden rounded-2xl bg-black/35 ring-1 ring-white/10 backdrop-blur-xl",children:i.jsx("video",{ref:Y,className:"w-full h-full",style:{aspectRatio:"16 / 9"},controls:!0,playsInline:!0,preload:"metadata",poster:j.cover,src:j.src},`video-${p}-${j?.src??"no-src"}`)})}),K&&i.jsx("div",{className:"w-full h-full flex items-center justify-center p-3 md:p-6",children:i.jsx("div",{className:"w-full max-w-5xl overflow-hidden rounded-2xl bg-black/35 ring-1 ring-white/10 backdrop-blur-xl",children:i.jsx("div",{className:"w-full",style:{aspectRatio:"16 / 9"},children:ue?i.jsx("iframe",{className:"h-full w-full",src:ue,title:j.title??"Embed",allow:"autoplay; encrypted-media; picture-in-picture",allowFullScreen:!0},he):i.jsx("div",{className:"grid h-full w-full place-items-center p-8",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-xs tracking-[0.35em] text-white/60 uppercase",children:"Invalid Embed URL"}),i.jsx("div",{className:"mt-2 text-sm text-white/40 break-all max-w-[80ch]",children:String(j?.src??"")})]})})})})})]})]})}),i.jsx(r,{children:M&&!D&&i.jsxs(i.Fragment,{children:[i.jsx(s.button,{type:"button",className:"\n                                absolute left-2 sm:left-3\n                                top-1/2 -translate-y-1/2\n                                z-10\n                                rounded-full bg-black/35 p-3 sm:p-3.5\n                                ring-1 ring-white/10 backdrop-blur-xl\n                                text-white/70 hover:text-white\n                                disabled:opacity-30 disabled:hover:text-white/70\n                                md:left-3\n                                ",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},transition:{duration:.18},disabled:!O,onClick:e=>{e.stopPropagation(),Q(),O&&w?.()},"aria-label":"Previous",title:"Previous (←)",children:i.jsx(f,{})}),i.jsx(s.button,{type:"button",className:"\n                                absolute right-2 sm:right-3\n                                top-1/2 -translate-y-1/2\n                                z-10\n                                rounded-full bg-black/35 p-3 sm:p-3.5\n                                ring-1 ring-white/10 backdrop-blur-xl\n                                text-white/70 hover:text-white\n                                disabled:opacity-30 disabled:hover:text-white/70\n                                md:right-3\n                                ",initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.18},disabled:!q,onClick:e=>{e.stopPropagation(),Q(),q&&y?.()},"aria-label":"Next",title:"Next (→)",children:i.jsx(g,{})})]})}),i.jsx(r,{children:D&&i.jsxs(s.div,{className:"absolute inset-0 z-20",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.18},onClick:e=>{e.stopPropagation(),Q(),S(!1)},onWheel:e=>e.stopPropagation(),onTouchMove:e=>e.stopPropagation(),children:[i.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-md"}),i.jsx(s.div,{className:"absolute left-1/2 top-1/2 w-[92vw] max-w-300 -translate-x-1/2 -translate-y-1/2",initial:{scale:.98,opacity:0,y:8},animate:{scale:1,opacity:1,y:0},exit:{scale:.98,opacity:0,y:8},transition:{duration:.18},onClick:e=>e.stopPropagation(),children:i.jsxs("div",{className:"rounded-2xl bg-black/40 ring-1 ring-white/10 shadow-[0_30px_120px_rgba(0,0,0,0.7)] overflow-hidden",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[i.jsx("div",{className:"text-[11px] tracking-[0.45em] text-white/60 uppercase",children:"GRID"}),i.jsx("button",{type:"button",onClick:()=>S(!1),className:"rounded-full bg-white/10 px-3 py-1 text-[11px] tracking-[0.35em] text-white/70 ring-1 ring-white/10 hover:bg-white/15",children:"CLOSE"})]}),i.jsx(n,{className:"h-[70vh] p-4",children:i.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-3",children:oe.map((e,t)=>i.jsxs("button",{type:"button",onClick:()=>{b?.(t),S(!1)},className:`relative overflow-hidden rounded-xl ring-1 ${t===p?"ring-white/40":"ring-white/10"} bg-white/5`,children:[i.jsx("img",{src:e.cover,alt:e.title??"thumb",loading:"lazy",decoding:"async",className:"h-20 w-full object-cover",draggable:!1}),i.jsx("div",{className:"absolute inset-0 bg-linear-to-t from-black/60 via-transparent to-transparent"}),i.jsx("div",{className:"absolute left-2 top-2 rounded-full bg-black/40 px-2 py-1 text-[9px] tracking-[0.35em] text-white/60 ring-1 ring-white/10",children:(e.type??"image").toUpperCase()})]},e.id??t))})})]})})]})}),i.jsx(r,{children:M&&i.jsx(s.div,{className:"pointer-events-none absolute bottom-3 left-1/2 -translate-x-1/2 z-10 md:hidden",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.18},children:i.jsxs("div",{className:"\n          flex items-center gap-2\n          rounded-full\n          bg-black/35 px-4 py-2\n          ring-1 ring-white/10 backdrop-blur-xl\n          max-w-[92vw]\n        ",children:[i.jsx("div",{className:"\n            min-w-0 flex-1\n            text-wrap\n            text-[11px] uppercase\n            tracking-[0.32em]\n            text-white/70\n          ",children:j.title??"UNTITLED"}),i.jsx("div",{className:"h-4 w-px bg-white/10"}),i.jsxs("div",{className:"\n            shrink-0\n            rounded-full\n            bg-white/5 px-2 py-1\n            text-[10px]\n            tracking-[0.28em]\n            text-white/55\n            ring-1 ring-white/10\n          ",children:[p+1,"/",k]})]})})})]})}),document.body):null}function l({title:e,icon:t,onClick:n,active:r=!1,disabled:s=!1}){return i.jsx("button",{type:"button",title:e,onClick:s?void 0:n,disabled:s,className:"grid place-items-center rounded-full p-2 transition "+(s?"opacity-30 cursor-not-allowed":r?"bg-white/15 text-white ring-1 ring-white/20":"bg-white/0 text-white/70 hover:bg-white/10 hover:text-white ring-1 ring-transparent hover:ring-white/10"),children:i.jsx("span",{className:"block h-5 w-5",children:t})})}function o(){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-full w-full",children:i.jsx("path",{d:"M12 5v14M5 12h14",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})})}function c(){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-full w-full",children:i.jsx("path",{d:"M5 12h14",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})})}function d(){return i.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-full w-full",children:[i.jsx("path",{d:"M20 12a8 8 0 1 1-2.34-5.66",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),i.jsx("path",{d:"M20 4v6h-6",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]})}function u(){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-full w-full",children:i.jsx("path",{d:"M4 4h7v7H4V4Zm9 0h7v7h-7V4ZM4 13h7v7H4v-7Zm9 0h7v7h-7v-7Z",stroke:"currentColor",strokeWidth:"1.4",strokeLinejoin:"round"})})}function h({playing:e,progress:t}){const n=2*Math.PI*9,r=n*(1-Math.max(0,Math.min(1,t)));return i.jsxs("span",{className:"relative block h-5 w-5",children:[i.jsx("span",{className:"absolute inset-0",children:e?i.jsx(p,{}):i.jsx(x,{})}),e&&i.jsxs("svg",{className:"absolute -inset-1",viewBox:"0 0 20 20",fill:"none",children:[i.jsx("circle",{cx:10,cy:10,r:9,stroke:"currentColor",strokeWidth:2,opacity:"0.18"}),i.jsx("circle",{cx:10,cy:10,r:9,stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeDasharray:n,strokeDashoffset:r,transform:"rotate(-90 10 10)",opacity:"0.85"})]})]})}function x(){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-full w-full",children:i.jsx("path",{d:"M9 7l10 5-10 5V7Z",stroke:"currentColor",strokeWidth:"1.6",strokeLinejoin:"round"})})}function p(){return i.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-full w-full",children:[i.jsx("path",{d:"M8 7v10",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),i.jsx("path",{d:"M16 7v10",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]})}function m(){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:"h-full w-full",children:i.jsx("path",{d:"M6 6l12 12M18 6L6 18",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})})}function f(){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:"size-5",children:i.jsx("path",{d:"M14.5 6.5L9 12l5.5 5.5",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"})})}function g(){return i.jsx("svg",{viewBox:"0 0 24 24",fill:"none",className:"size-5",children:i.jsx("path",{d:"M9.5 6.5L15 12l-5.5 5.5",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round"})})}export{a as L};
